<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content="" />
    <meta property="og:image" content="" />
    <meta property="og:url" content="" />
    <meta property="og:site_name" content="" />
    <meta property="og:description" content="" />
    <meta name="twitter:title" content="" />
    <meta name="twitter:image" content="" />
    <meta name="twitter:url" content="" />
    <meta name="twitter:card" content="" />
    <script
      src="../static/myJs/fontawesome.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="../static/elementui/theme-chalk/index.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,700"
      rel="stylesheet"
    />

    <!-- Animate.css -->
    <link rel="stylesheet" href="../static/css/animate.css" />
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="../static/css/icomoon.css" />
    <!-- Themify Icons-->
    <link rel="stylesheet" href="../static/css/themify-icons.css" />
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="../static/css/bootstrap.css" />

    <!-- Magnific Popup -->
    <link rel="stylesheet" href="../static/css/magnific-popup.css" />

    <!-- Owl Carousel  -->
    <link rel="stylesheet" href="../static/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="../static/css/owl.theme.default.min.css" />

    <!-- Theme style  -->
    <link rel="stylesheet" href="../static/css/style.css" />

    <!-- Modernizr JS -->
    <script src="../static/js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
      <script src="../static/js/respond.min.js"></script>
    <![endif]-->
    <title>登录</title>
  </head>
  <body>
    <div id="app">
      <div class="gtco-loader"></div>

      <div
        id="page"
        style="
          background-image: url('../static/img/img_1.jpg');
          background-repeat: no-repeat;
          background-size: 100%;
        "
      >
        {% csrf_token %}

        <div class="page-inner">
          <nav class="gtco-nav" role="navigation">
            <div class="gtco-container">
              <div class="row">
                <div class="col-sm-4 col-xs-12">
                  <div id="gtco-logo">
                    <a href="#">RS-Seg System<em>.</em></a>
                  </div>
                </div>
                <div class="col-xs-8 text-right menu-1">
                  <ul>
                    <li><a href="/admin">管理员登陆</a></li>
                    <li class="btn-cta">
                      <a href="/getstart"><span>Get started</span></a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </nav>

          <header id="gtco-header" class="gtco-cover" role="banner">
            <div class="overlay"></div>
            <div class="gtco-container">
              <div class="row">
                <div class="col-md-14 col-md-offset-0 text-left">
                  <div class="row row-mt-15em">
                    <div
                      class="col-md-7 mt-text animate-box"
                      data-animate-effect="fadeInUp"
                    >
                      <span class="intro-text-small">Welcome to System</span>
                      <h1>遥感影像地块分割系统</h1>
                    </div>
                    <div
                      class="col-md-4 col-md-push-1 animate-box"
                      data-animate-effect="fadeInRight"
                    >
                      <div class="form-wrap">
                        <div class="tab">
                          <ul class="tab-menu">
                            <li class="gtco-first active">
                              <a href="#" data-tab="login">登录</a>
                            </li>
                            <li class="gtco-second">
                              <a href="#" data-tab="signup">注册</a>
                            </li>
                          </ul>
                          <div class="tab-content">
                            <div
                              class="tab-content-inner"
                              data-content="signup"
                            >
                              <div class="row form-group">
                                <div class="col-md-12">
                                  <label for="username">使用用户名注册</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="username"
                                    v-model="sign_form.username"
                                  />
                                </div>
                              </div>
                              <div class="row form-group">
                                <div class="col-md-12">
                                  <label for="password">密码</label>
                                  <input
                                    type="password"
                                    class="form-control"
                                    id="password"
                                    v-model="sign_form.password"
                                  />
                                </div>
                              </div>
                              <div class="row form-group">
                                <div class="col-md-12">
                                  <label for="password2">重复密码</label>
                                  <input
                                    type="password"
                                    class="form-control"
                                    id="password2"
                                    v-model="sign_form.re_password"
                                  />
                                </div>
                              </div>

                              <div class="row form-group">
                                <div class="col-md-12">
                                  <button class="btn btn-primary" @click="sign">
                                    注册
                                  </button>
                                </div>
                              </div>
                            </div>

                            <div
                              class="tab-content-inner active"
                              data-content="login"
                            >
                              <div class="row form-group">
                                <div class="col-md-12">
                                  <label for="username">使用用户名登录</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="username"
                                    v-model="login_form.username"
                                  />
                                </div>
                              </div>
                              <div class="row form-group">
                                <div class="col-md-12">
                                  <label for="password">密码</label>
                                  <input
                                    type="password"
                                    class="form-control"
                                    id="password"
                                    v-model="login_form.password"
                                  />
                                </div>
                              </div>

                              <div class="row form-group">
                                <div class="col-md-12">
                                  <button
                                    class="btn btn-primary"
                                    @click="login"
                                  >
                                    登录
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </header>
        </div>

        <footer id="gtco-footer" role="contentinfo">
          基于深度学习的遥感图像地块分割系统<br />
          联系我们：13xxxxxxxxx<br />
          <img style="width: 5%; margin: 1em" src="\static\img\qrcode.jpg" alt="qrcode" /><br />
          ©Copyright Xxxxxxx
        </footer>
      </div>

      <div class="gototop js-top">
        <a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
      </div>
    </div>

    <script src="/static/axios/axios.min.js"></script>
    <script src="/static/vue/vue.js"></script>
    <script src="/static/elementui/index.js"></script>
    <!-- jQuery -->
    <script src="/static/js/jquery.min.js"></script>
    <!-- jQuery Easing -->
    <script src="/static/js/jquery.easing.1.3.js"></script>
    <!-- Bootstrap -->
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- Waypoints -->
    <script src="/static/js/jquery.waypoints.min.js"></script>
    <!-- Carousel -->
    <script src="/static/js/owl.carousel.min.js"></script>
    <!-- countTo -->
    <script src="/static/js/jquery.countTo.js"></script>
    <!-- Magnific Popup -->
    <script src="/static/js/jquery.magnific-popup.min.js"></script>
    <script src="/static/js/magnific-popup-options.js"></script>
    <!-- Main -->
    <script src="/static/js/main.js"></script>

    <script>
      axios.interceptors.request.use((request) => {
        if (request.method === "post") {
          let csrf_token = document.querySelector(
            'input[name = "csrfmiddlewaretoken"]'
          ).value;
          request.headers["X-CSRFToken"] = csrf_token;
        }
        return request;
      });
      axios.interceptors.response.use((response) => {
        return response.data;
      });

      new Vue({
        el: "#app",
        data: {
          container: ["container"],

          login_form: {
            username: "",
            password: "",
          },

          sign_form: {
            username: "",
            password: "",
            re_password: "",
          },
        },

        methods: {
          login() {
            axios.post(`/api/login/`, this.login_form).then((res) => {
              if (res.code) {
                this.$message.error(res.msg);
                this.$refs[`login_form_${res.self}`].focus();
                return;
              }

              this.$message.success(res.msg);
              setTimeout(() => {
                location.href = "/upload";
              }, 1000);
            });
          },

          sign() {
            axios.post(`/api/sign/`, this.sign_form).then((res) => {
              if (res.code) {
                this.$message.error(res.msg);
                this.$refs[`sign_form_${res.self}`].focus();
                return;
              }

              this.$message.success(res.msg);
              setTimeout(() => {
                location.href = "/";
              }, 1000);
            });
          },

          increase() {
            this.container.push("sign-up-mode");
          },

          decrease() {
            this.container = ["container"];
          },
        },
      });
    </script>
  </body>
</html>
